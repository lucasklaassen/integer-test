<div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
  <header class="masthead">
    <div class="inner">
      <div class="d-flex justify-content-between align-items-center flex-row">
        <nav class="nav nav-masthead justify-content-center">
          <a class="nav-link active" [routerLink]="['/scheduled-events']"
            >Back</a
          >
        </nav>
        <h3 class="masthead-brand">Fights</h3>
        <nav class="nav nav-masthead justify-content-center">
          <a class="nav-link active" [routerLink]="['/logout']">Logout</a>
        </nav>
      </div>
    </div>
  </header>

  <main *ngIf="currentEvent" role="main" class="inner cover">
    <h3 class="text-center" style="color: #fff">
      {{ currentEvent.name }}
    </h3>
    <h6 *ngIf="!userHasMadePicks" class="text-center text-info">
      Click the fighters you think will win, then submit.
    </h6>
    <h6 *ngIf="userHasMadePicks" class="text-center text-success">
      You can edit your picks up until the fight starts. Good luck!
    </h6>
    <button
      (click)="toggleImages()"
      *ngIf="!userHasMadePicks"
      type="button"
      class="btn btn-info w-100 mt-2"
    >
      <span *ngIf="!viewImages">Show Image Viewer</span>
      <span *ngIf="viewImages">Hide Image Viewer</span>
    </button>
    <button
      (click)="toggleFriendPicks()"
      *ngIf="userHasMadePicks && friendPicks && friendPicks.length"
      type="button"
      class="btn btn-info w-100 mt-2"
    >
      <span *ngIf="!showFriendPicks">Show Me My Friends Picks</span>
      <span *ngIf="showFriendPicks">Hide Friend Picks</span>
    </button>
    <iframe
      *ngIf="viewImages"
      class="w-100 mt-2"
      style="border: none; height: 500px"
      src="https://www.google.com/search?igu=1&ei=&q=ufc"
    ></iframe>
    <ng-container *ngIf="!showFriendPicks">
      <div *ngFor="let fight of fights; let i = index" class="row">
        <div class="d-flex flex-row w-100 fight mt-2">
          <div
            *ngFor="let fighter of fight.fighters; let i = index"
            (click)="pickFighter(fight.id, fighter.id)"
            [ngClass]="{
              'border-right': i % 2 === 0,
              picked: checkIfPicked(fight.id, fighter.id, userPicks)
            }"
            class="col-sm-6 py-4 px-3 fighter clickable"
          >
            <p class="fighter-name m-0">
              {{ fighter.firstName }} {{ fighter.lastName }}
            </p>
            <p class="fighter-record m-0">
              {{ fighter.preFightWins }} - {{ fighter.preFightLosses }} -
              {{ fighter.preFightDraws }}
            </p>
            <p class="fighter-record m-0">
              <span *ngIf="favourite(fight.fighters, i)"
                >Favourite: {{ fighter.moneyline }}</span
              >
              <span *ngIf="!favourite(fight.fighters, i)"
                >Underdog: {{ fighter.moneyline }}</span
              >
            </p>
          </div>
        </div>
        <div class="d-flex flex-row w-100 results">
          <div class="col-sm-12 px-3 text-center d-flex flex-column">
            <span class="m-0">{{ resultText(fight) }}</span>
            <span class="m-0">{{ userResultText(fight, userPicks) }}</span>
          </div>
        </div>
      </div>
    </ng-container>

    <ng-container *ngIf="showFriendPicks">
      <ng-container *ngFor="let friendPick of friendPicks">
        <h3 class="text-center mt-2" style="color: #fff">
          {{ friendPick.name }} Picked
        </h3>
        <div *ngFor="let fight of fights; let i = index" class="row">
          <div class="d-flex flex-row w-100 fight friend-pick my-2">
            <div
              *ngFor="let fighter of fight.fighters; let i = index"
              [ngClass]="{
                'border-right': i % 2 === 0,
                picked: checkIfPicked(
                  fight.id,
                  fighter.id,
                  friendPick.userPicks
                )
              }"
              class="col-sm-6 py-4 px-3 fighter"
            >
              <p class="fighter-name m-0">
                {{ fighter.firstName }} {{ fighter.lastName }}
              </p>
              <p class="fighter-record m-0">
                {{ fighter.preFightWins }} - {{ fighter.preFightLosses }} -
                {{ fighter.preFightDraws }}
              </p>
              <p class="fighter-record m-0">
                <span *ngIf="favourite(fight.fighters, i)"
                  >Favourite: {{ fighter.moneyline }}</span
                >
                <span *ngIf="!favourite(fight.fighters, i)"
                  >Underdog: {{ fighter.moneyline }}</span
                >
              </p>
            </div>
          </div>
        </div>
      </ng-container>
    </ng-container>

    <button
      (click)="toggleFriendPicks()"
      *ngIf="userHasMadePicks && showFriendPicks"
      type="button"
      class="btn btn-info w-100 mt-2"
    >
      <span *ngIf="showFriendPicks">Hide Friend Picks</span>
    </button>

    <button
      *ngIf="!eventComplete && !showFriendPicks"
      (click)="savePicks()"
      type="button"
      class="btn btn-success w-100 mt-2"
    >
      {{ submitText }}
    </button>
  </main>
</div>
